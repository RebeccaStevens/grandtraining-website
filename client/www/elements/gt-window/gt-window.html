<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../../bower_components/iron-pages/iron-pages.html">
<link rel="import" href="../../bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="../../bower_components/paper-tabs/paper-tab.html">

<dom-module id="gt-window">
  <style>
    :host {
      display: block;
      border: var(--gt-window-bezal-border, solid 1px navy);
      background: var(--gt-window-bezal-color, lightblue);
      position: relative;
      margin: 8px 8px 8px 2px;
    }
    #bezal {
      background-color: var(--gt-window-background-color, white);
      border: var(--gt-window-bezal-border, solid 1px navy);
      position: absolute;
      top: 30px;
      right: 6px;
      bottom: 6px;
      left: 6px;
      @apply(--layout-vertical);
    }
    #ribbon-menu {
      height: 26px;
      border-bottom: var(--gt-window-ribbon-border-bottom, solid 1px navy);
    }
    #ribbon-menu paper-tab {
      flex: 0;
      padding: 0 60px;
    }
    #content {
      position: relative;
      overflow: auto;
      @apply(--layout-flex);
    }
    #title-bar {
      text-align: center;
      height: 30px;
      font-size: var(--gt-window-title-bar-font-size, 12pt);
      font-family: var(--gt-window-title-bar-font-family, sans-serif);
      @apply(--layout-vertical);
      @apply(--layout-center-justified);
    }
    #window-icon {
      position: absolute;
      top: 0;
      left: 0;
      width: 30px;
      height: 30px;
      @apply(--layout-vertical);
      @apply(--layout-center-justified);
    }
    #window-icon > div {
      @apply(--layout-horizontal);
      @apply(--layout-center-justified);
    }
    /* start control-box */
    #control-box {
      position: absolute;
      top: 0;
      right: 6px;
      @apply(--layout-horizontal);
    }
    #control-box > .control{
      width: 45px;
      height: 30px;
      margin-left: 1px;
      @apply(--gt-window-control-box-button);
    }
    #minimize {
      @apply(--gt-window-minimize-button);
    }
    #minimize:hover {
      background-color: var(--gt-window-minimize-button-color-hover, lightgrey);
      @apply(--gt-window-minimize-button-hover);
    }
    #minimize:active {
      background-color: var(--gt-window-minimize-button-color-active, grey);
      @apply(--gt-window-minimize-button-active);
    }
    #maximize {
      @apply(--gt-window-maximize-button);
    }
    #maximize:hover {
      background-color: var(--gt-window-maximize-button-color-hover, lightgrey);
      @apply(--gt-window-maximize-button-hover);
    }
    #maximize:active {
      background-color: var(--gt-window-maximize-button-color-active, grey);
      @apply(--gt-window-maximize-button-active);
    }
    #restore {
      @apply(--gt-window-restore-button);
    }
    #restore:hover {
      background-color: var(--gt-window-maximize-button-color-hover, lightgrey);
      @apply(--gt-window-restore-button-hover);
    }
    #restore:active {
      background-color: var(--gt-window-maximize-button-color-active, grey);
      @apply(--gt-window-restore-active);
    }
    #close {
      @apply(--gt-window-close-button);
    }
    #close:hover {
      background-color: var(--gt-window-close-button-color-hover, red);
      @apply(--gt-window-close-button-hover);
    }
    #close:active {
      background-color: var(--gt-window-close-button-color-active, darkred);
      @apply(--gt-window-close-button-active);
    }
    /* end control-box */
  </style>
  <template>
    <div id="control-box">
      <div id="minimize" class="control" title="Minimize" role="button"></div>
      <div id="maximize" class="control" title="Maximize" role="button" hidden$="{{maximized}}"></div>
      <div id="restore" class="control" title="Restore" role="button" hidden$="{{!maximized}}"></div>
      <div id="close" class="control" title="Close" role="button"></div>
    </div>
    <div id="window-icon"><div><content select=".window-icon"></content></div></div>
    <div id="title-bar" class="flex"><span>{{windowTitle}}</span></div>
    <div id="bezal">
      <paper-tabs id="ribbon-menu" selected="{{selectedRibbon}}">
        <template is="dom-repeat" items="{{_ribbonMenus}}">
          <paper-tab>{{item.dataset.ribbonTitle}}</paper-tab>
        </template>
      </paper-tabs>
      <iron-pages id="ribbon" selected="{{selectedRibbon}}">
        <content id="ribbonMenus" select=".ribbon-menu"></content>
      </iron-pages>
      <div id="content">
        <content></content>
      </div>
    </div>
  </template>
</dom-module>
<script>
  (function() {
    'use strict';
    class GTWindow {

      /**
       * The name of this element.
       *
       * @return {String}
       */
      get is() {
        return 'gt-window';
      }

      /**
       * This element's properties.
       *
       * @return {Object}
       */
      get properties() {
        return {
          /**
           * The text display in the titlebar of the window.
           */
          windowTitle: {
            type: String,
            value: ''
          },

          /**
           * Whether or not the window is maximized.
           */
          maximized: {
            type: Boolean,
            value: false
          },

          /**
           * The distribute ribbon menus.
           */
          _ribbonMenus: {
            type: Array,
            readOnly: true,
            value: []
          }
        };
      }

      /**
       * Called when the element is attached to its parent DOM.
       */
      attached() {
        // set the distributed ribbon menus
        this.async(function(){
          this.updateRibbonMenuTabs();
        });
      }

      /**
       * Update the ribbon menu tabs.
       */
      updateRibbonMenuTabs() {
        // jshint -W106
        this._set_ribbonMenus(Polymer.dom(this.$.ribbonMenus).getDistributedNodes());
      }
    }

    Polymer(GTWindow);
  })();
</script>
